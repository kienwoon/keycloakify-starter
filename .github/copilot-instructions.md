<!-- Copied and adapted for AI coding agents: concise, actionable, repository-specific guidance -->
# Copilot instructions for this repository

This repo is a Keycloak theme starter built with Keycloakify (v11) and React + Vite. Use these notes to be productive immediately.

- **Big picture:** The project produces a Keycloak theme (JARs) using `keycloakify` and a local dev preview using Vite + Storybook. Theme sources live under `src/` and React pages are rendered via an auto-generated entry `src/kc.gen.tsx`.

- **Entry points & generation:**
  - `src/kc.gen.tsx`: auto-generated by the `update-kc-gen` workflow. Do NOT edit manually. Look here to see which pages/components are exposed to the app.
  - `src/main.tsx`: Vite dev entry. For local page previews, developers often uncomment the block that uses `getKcContextMock` from `src/login/KcPageStory.tsx`.
  - `vite.config.ts`: contains the `keycloakify` Vite plugin configuration.

- **Where to make changes:**
  - UI and theme logic: `src/login/*` (notably `KcPage.tsx`, `KcContext.ts`, `i18n.ts`, `KcPageStory.tsx`).
  - Add or extend translations in `src/login/i18n.ts` using the `i18nBuilder` pattern already in place.
  - To extend the keycloak context shape, edit `src/login/KcContext.ts` (it exports `KcContext` used across the project).

- **Dev workflows & commands (from `package.json`):**
  - Start dev server: `npm run dev` (Vite). Use `main.tsx` mocks to preview specific pages.
  - Build production bundle: `npm run build` (runs `tsc && vite build`).
  - Build Keycloak theme (produces JARs): `npm run build-keycloak-theme` — this runs the build and then `keycloakify build`. Packaging requires Maven and Java on PATH (see README).
  - Run Storybook: `npm run storybook` (visual component testing).
  - Format: `npm run format` (Prettier).

- **How to preview pages quickly:**
  - Option A: In `src/main.tsx` uncomment the `getKcContextMock` example to set `window.kcContext` for Vite dev and open `http://localhost:5173`.
  - Option B: Use Storybook (`npm run storybook`) — components/stories are driven by `src/login/KcPageStory.tsx`.

- **Important patterns & conventions:**
  - Lazy loading + suspense is used for Keycloak pieces (see `src/kc.gen.tsx` and `src/login/KcPage.tsx`).
  - `KcPage` dispatches on `kcContext.pageId` (use `switch` in `KcPage.tsx` to add custom pages).
  - `classes` objects use TypeScript `satisfies` to keep type-safety with `ClassKey`.
  - Keep edits confined to `src/login/*` and avoid touching generated files like `kc.gen.tsx`.

- **I18n:** `src/login/i18n.ts` uses `i18nBuilder.withThemeName<ThemeName>().build()` — follow that pattern when adding localized strings.

- **Releases & CI:** The README notes a GitHub Actions workflow that builds and publishes JAR artifacts when `package.json` version is bumped and pushed. To enable workflow, ensure Actions permissions are set in repository settings.

- **Environment & constraints:** Node must match `engines.node` in `package.json` (>=18 or >=20). The theme packaging step requires Maven + Java on PATH.

- **Quick checks an agent should perform before editing:**
  1. Verify file is not generated (`kc.gen.tsx` header contains “auto-generated”).
  2. Run `npm run dev` or `npm run storybook` locally to validate UI changes.
  3. For theme packaging changes, run `npm run build-keycloak-theme` (Maven required).

- **When submitting patches:** keep changes minimal and focused (edit `src/login/*`). If you add new files or change types in `KcContext`, update `src/login/KcPageStory.tsx` mocks so local dev and Storybook continue to work.

If any of these notes are unclear or you want more specifics (example PR checklist, added scripts, or extra examples), tell me which section to expand. 
